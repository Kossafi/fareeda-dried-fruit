<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•≠</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gold: #FFD700;
            --primary-orange: #FFA500;
            --primary-deep-orange: #FF8C00;
            --bg-cream: #FFF8DC;
            --bg-light-yellow: #FFFACD;
            --bg-warm-white: #FEFEF7;
            --text-dark: #2C1810;
            --text-brown: #8B4513;
            --success-green: #32CD32;
            --warning-amber: #FFBF00;
            --danger-red: #FF6B6B;
            --shadow-warm: rgba(255, 165, 0, 0.15);
            --shadow-soft: rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Prompt', sans-serif;
            background: linear-gradient(135deg, var(--bg-cream) 0%, var(--bg-light-yellow) 100%);
            color: var(--text-dark);
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--primary-orange) 100%);
            padding: 1rem 0;
            box-shadow: 0 4px 20px var(--shadow-warm);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--text-dark) !important;
        }

        .form-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 248, 220, 0.8) 100%);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 800px;
            box-shadow: 0 10px 30px var(--shadow-soft);
            border: 1px solid rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .form-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--primary-orange);
        }

        .form-header h1 {
            color: var(--primary-deep-orange);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            border-left: 4px solid var(--primary-orange);
        }

        .form-section h3 {
            color: var(--text-brown);
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .form-control {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 0.75rem;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 0.2rem rgba(255, 165, 0, 0.25);
        }

        .form-label {
            font-weight: 500;
            color: var(--text-brown);
            margin-bottom: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-deep-orange) 100%);
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 140, 0, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 140, 0, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-green) 0%, #228B22 100%);
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-weight: 600;
            color: white;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(50, 205, 50, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(50, 205, 50, 0.4);
        }

        .items-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px var(--shadow-soft);
        }

        .table {
            margin-bottom: 0;
        }

        .table thead th {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--primary-orange) 100%);
            color: var(--text-dark);
            font-weight: 600;
            border: none;
            padding: 1rem;
        }

        .table tbody td {
            padding: 0.75rem;
            vertical-align: middle;
            border-color: rgba(255, 215, 0, 0.2);
        }

        .add-item-btn {
            width: 100%;
            padding: 0.75rem;
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--primary-orange) 100%);
            border: none;
            border-radius: 10px;
            color: var(--text-dark);
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .add-item-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--shadow-warm);
        }

        .remove-item-btn {
            background: var(--danger-red);
            border: none;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 5px;
            font-size: 0.875rem;
        }

        .total-section {
            background: linear-gradient(135deg, var(--bg-cream) 0%, var(--bg-light-yellow) 100%);
            padding: 1.5rem;
            border-radius: 15px;
            margin-top: 2rem;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
        }

        .total-row.final {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary-deep-orange);
            border-top: 2px solid var(--primary-orange);
            padding-top: 1rem;
        }

        .preview-section {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid var(--primary-orange);
            margin-top: 2rem;
            display: none;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .status-pending {
            background: var(--warning-amber);
            color: var(--text-dark);
        }

        .status-sent {
            background: var(--success-green);
            color: white;
        }

        @media (max-width: 768px) {
            .form-container {
                margin: 1rem;
                padding: 1.5rem;
            }
            
            .form-section {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-seedling"></i>
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á
            </a>
            <div class="ms-auto">
                <a href="/" class="btn btn-outline-dark">
                    <i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="form-container">
            <div class="form-header">
                <h1>
                    <i class="fas fa-shopping-cart"></i>
                    ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                </h1>
                <p class="text-muted">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå</p>
            </div>

            <form id="purchaseForm">
                <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ -->
                <div class="form-section">
                    <h3>
                        <i class="fas fa-info-circle"></i>
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
                    </h3>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</label>
                                <input type="text" class="form-control" id="poNumber" readonly>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</label>
                                <input type="date" class="form-control" id="orderDate" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                                <input type="date" class="form-control" id="deliveryDate" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</label>
                                <input type="text" class="form-control" id="buyerName" required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå -->
                <div class="form-section">
                    <h3>
                        <i class="fas fa-truck"></i>
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå
                    </h3>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå</label>
                                <select class="form-control" id="supplierName" required>
                                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå --</option>
                                    <option value="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î</option>
                                    <option value="‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ú‡∏•‡πÑ‡∏°‡πâ">‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ú‡∏•‡πÑ‡∏°‡πâ</option>
                                    <option value="‡πÄ‡∏ô‡πÄ‡∏à‡∏≠‡∏£‡∏±‡∏• ‡∏î‡∏£‡∏≤‡∏¢‡∏ü‡∏£‡∏∏‡πâ‡∏ï">‡πÄ‡∏ô‡πÄ‡∏à‡∏≠‡∏£‡∏±‡∏• ‡∏î‡∏£‡∏≤‡∏¢‡∏ü‡∏£‡∏∏‡πâ‡∏ï</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                <input type="tel" class="form-control" id="supplierPhone" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                                <input type="email" class="form-control" id="supplierEmail" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                                <input type="text" class="form-control" id="supplierAddress" required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
                <div class="form-section">
                    <h3>
                        <i class="fas fa-list"></i>
                        ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                    </h3>
                    <div class="items-table">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                                    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                    <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                    <th>‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                    <th>‡∏£‡∏ß‡∏°</th>
                                    <th>‡∏•‡∏ö</th>
                                </tr>
                            </thead>
                            <tbody id="itemsTableBody">
                                <tr>
                                    <td>
                                        <input type="text" class="form-control" name="itemName[]" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" required>
                                    </td>
                                    <td>
                                        <input type="number" class="form-control item-quantity" name="itemQuantity[]" min="1" required>
                                    </td>
                                    <td>
                                        <select class="form-control" name="itemUnit[]" required>
                                            <option value="">‡∏´‡∏ô‡πà‡∏ß‡∏¢</option>
                                            <option value="‡∏Å‡∏Å.">‡∏Å‡∏Å.</option>
                                            <option value="‡∏Å‡∏£‡∏±‡∏°">‡∏Å‡∏£‡∏±‡∏°</option>
                                            <option value="‡∏ä‡∏¥‡πâ‡∏ô">‡∏ä‡∏¥‡πâ‡∏ô</option>
                                            <option value="‡∏•‡∏±‡∏á">‡∏•‡∏±‡∏á</option>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="number" class="form-control item-price" name="itemPrice[]" min="0" step="0.01" required>
                                    </td>
                                    <td>
                                        <span class="item-total">0.00</span>
                                    </td>
                                    <td>
                                        <button type="button" class="remove-item-btn" onclick="removeItem(this)">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button type="button" class="add-item-btn mt-3" onclick="addItem()">
                        <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                    </button>
                </div>

                <!-- ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° -->
                <div class="total-section">
                    <div class="total-row">
                        <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</span>
                        <span id="subtotal">‡∏ø0.00</span>
                    </div>
                    <div class="total-row">
                        <span>‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° (7%):</span>
                        <span id="vat">‡∏ø0.00</span>
                    </div>
                    <div class="total-row final">
                        <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</span>
                        <span id="grandTotal">‡∏ø0.00</span>
                    </div>
                </div>

                <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ -->
                <div class="form-section">
                    <h3>
                        <i class="fas fa-sticky-note"></i>
                        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
                    </h3>
                    <textarea class="form-control" id="notes" rows="3" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></textarea>
                </div>

                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ -->
                <div class="text-center">
                    <button type="button" class="btn btn-primary me-3" onclick="previewOrder()">
                        <i class="fas fa-eye"></i> ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                    </button>
                    <button type="button" class="btn btn-success" onclick="confirmOrder()">
                        <i class="fas fa-check-circle"></i> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                    </button>
                </div>
            </form>

            <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ -->
            <div class="preview-section" id="previewSection">
                <h4>
                    <i class="fas fa-file-alt"></i>
                    ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                </h4>
                <div id="previewContent"></div>
                <div class="text-center mt-3">
                    <button type="button" class="btn btn-primary" onclick="printOrder()">
                        <i class="fas fa-print"></i> ‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏ó‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Generate PO Number
        function generatePONumber() {
            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const time = String(date.getHours()).padStart(2, '0') + String(date.getMinutes()).padStart(2, '0');
            return `PO-${year}${month}${day}-${time}`;
        }

        // Initialize form
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('poNumber').value = generatePONumber();
            document.getElementById('orderDate').value = new Date().toISOString().split('T')[0];
            
            // Set default delivery date (7 days from today)
            const deliveryDate = new Date();
            deliveryDate.setDate(deliveryDate.getDate() + 7);
            document.getElementById('deliveryDate').value = deliveryDate.toISOString().split('T')[0];
            
            // Auto-fill supplier data
            document.getElementById('supplierName').addEventListener('change', function() {
                const suppliers = {
                    '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î': {
                        phone: '02-123-4567',
                        email: 'info@driedfruit.co.th',
                        address: '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110'
                    },
                    '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ú‡∏•‡πÑ‡∏°‡πâ': {
                        phone: '02-234-5678',
                        email: 'sales@fruitcoop.com',
                        address: '456 ‡∏ñ‡∏ô‡∏ô‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô ‡πÅ‡∏Ç‡∏ß‡∏á‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£ ‡πÄ‡∏Ç‡∏ï‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10900'
                    },
                    '‡πÄ‡∏ô‡πÄ‡∏à‡∏≠‡∏£‡∏±‡∏• ‡∏î‡∏£‡∏≤‡∏¢‡∏ü‡∏£‡∏∏‡πâ‡∏ï': {
                        phone: '02-345-6789',
                        email: 'contact@naturalfruit.th',
                        address: '789 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏±‡∏ä‡∏î‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å ‡πÅ‡∏Ç‡∏ß‡∏á‡∏î‡∏¥‡∏ô‡πÅ‡∏î‡∏á ‡πÄ‡∏Ç‡∏ï‡∏î‡∏¥‡∏ô‡πÅ‡∏î‡∏á ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10400'
                    }
                };
                
                const selected = suppliers[this.value];
                if (selected) {
                    document.getElementById('supplierPhone').value = selected.phone;
                    document.getElementById('supplierEmail').value = selected.email;
                    document.getElementById('supplierAddress').value = selected.address;
                }
            });
            
            // Calculate totals on input change
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('item-quantity') || e.target.classList.contains('item-price')) {
                    calculateTotals();
                }
            });
        });

        // Add new item row
        function addItem() {
            const tbody = document.getElementById('itemsTableBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>
                    <input type="text" class="form-control" name="itemName[]" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" required>
                </td>
                <td>
                    <input type="number" class="form-control item-quantity" name="itemQuantity[]" min="1" required>
                </td>
                <td>
                    <select class="form-control" name="itemUnit[]" required>
                        <option value="">‡∏´‡∏ô‡πà‡∏ß‡∏¢</option>
                        <option value="‡∏Å‡∏Å.">‡∏Å‡∏Å.</option>
                        <option value="‡∏Å‡∏£‡∏±‡∏°">‡∏Å‡∏£‡∏±‡∏°</option>
                        <option value="‡∏ä‡∏¥‡πâ‡∏ô">‡∏ä‡∏¥‡πâ‡∏ô</option>
                        <option value="‡∏•‡∏±‡∏á">‡∏•‡∏±‡∏á</option>
                    </select>
                </td>
                <td>
                    <input type="number" class="form-control item-price" name="itemPrice[]" min="0" step="0.01" required>
                </td>
                <td>
                    <span class="item-total">0.00</span>
                </td>
                <td>
                    <button type="button" class="remove-item-btn" onclick="removeItem(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            `;
            tbody.appendChild(newRow);
        }

        // Remove item row
        function removeItem(button) {
            const row = button.closest('tr');
            const tbody = document.getElementById('itemsTableBody');
            if (tbody.children.length > 1) {
                row.remove();
                calculateTotals();
            } else {
                alert('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            }
        }

        // Calculate totals
        function calculateTotals() {
            let subtotal = 0;
            const rows = document.querySelectorAll('#itemsTableBody tr');
            
            rows.forEach(row => {
                const quantity = parseFloat(row.querySelector('.item-quantity').value) || 0;
                const price = parseFloat(row.querySelector('.item-price').value) || 0;
                const total = quantity * price;
                
                row.querySelector('.item-total').textContent = total.toFixed(2);
                subtotal += total;
            });
            
            const vat = subtotal * 0.07;
            const grandTotal = subtotal + vat;
            
            document.getElementById('subtotal').textContent = '‡∏ø' + subtotal.toLocaleString('th-TH', {minimumFractionDigits: 2});
            document.getElementById('vat').textContent = '‡∏ø' + vat.toLocaleString('th-TH', {minimumFractionDigits: 2});
            document.getElementById('grandTotal').textContent = '‡∏ø' + grandTotal.toLocaleString('th-TH', {minimumFractionDigits: 2});
        }

        // Preview order
        function previewOrder() {
            const form = document.getElementById('purchaseForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const formData = collectFormData();
            const previewHTML = generatePreviewHTML(formData);
            
            document.getElementById('previewContent').innerHTML = previewHTML;
            document.getElementById('previewSection').style.display = 'block';
            
            // Scroll to preview
            document.getElementById('previewSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Collect form data
        function collectFormData() {
            const formData = {
                poNumber: document.getElementById('poNumber').value,
                orderDate: document.getElementById('orderDate').value,
                deliveryDate: document.getElementById('deliveryDate').value,
                buyerName: document.getElementById('buyerName').value,
                supplier: {
                    name: document.getElementById('supplierName').value,
                    phone: document.getElementById('supplierPhone').value,
                    email: document.getElementById('supplierEmail').value,
                    address: document.getElementById('supplierAddress').value
                },
                items: [],
                notes: document.getElementById('notes').value
            };
            
            // Collect items
            const rows = document.querySelectorAll('#itemsTableBody tr');
            rows.forEach(row => {
                const name = row.querySelector('input[name="itemName[]"]').value;
                const quantity = parseFloat(row.querySelector('input[name="itemQuantity[]"]').value) || 0;
                const unit = row.querySelector('select[name="itemUnit[]"]').value;
                const price = parseFloat(row.querySelector('input[name="itemPrice[]"]').value) || 0;
                
                if (name && quantity > 0 && unit && price > 0) {
                    formData.items.push({
                        name,
                        quantity,
                        unit,
                        price,
                        total: quantity * price
                    });
                }
            });
            
            return formData;
        }

        // Generate preview HTML
        function generatePreviewHTML(data) {
            const subtotal = data.items.reduce((sum, item) => sum + item.total, 0);
            const vat = subtotal * 0.07;
            const grandTotal = subtotal + vat;
            
            let itemsHTML = '';
            data.items.forEach((item, index) => {
                itemsHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.name}</td>
                        <td class="text-center">${item.quantity}</td>
                        <td class="text-center">${item.unit}</td>
                        <td class="text-end">‡∏ø${item.price.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                        <td class="text-end">‡∏ø${item.total.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                    </tr>
                `;
            });
            
            return `
                <div class="preview-document">
                    <div class="text-center mb-4">
                        <h4>‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Purchase Order)</h4>
                        <h5>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</h5>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${data.poNumber}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${new Date(data.orderDate).toLocaleDateString('th-TH')}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</strong> ${new Date(data.deliveryDate).toLocaleDateString('th-TH')}
                        </div>
                        <div class="col-md-6">
                            <strong>‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${data.buyerName}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå:</strong> ${new Date().toLocaleDateString('th-TH')}<br>
                            <strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${new Date().toLocaleTimeString('th-TH')}
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <strong>‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå:</strong><br>
                        ${data.supplier.name}<br>
                        ‡πÇ‡∏ó‡∏£: ${data.supplier.phone}<br>
                        ‡∏≠‡∏µ‡πÄ‡∏°‡∏•: ${data.supplier.email}<br>
                        ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${data.supplier.address}
                    </div>
                    
                    <table class="table table-bordered">
                        <thead class="table-warning">
                            <tr>
                                <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                <th>‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                <th>‡∏£‡∏ß‡∏°</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${itemsHTML}
                        </tbody>
                    </table>
                    
                    <div class="row">
                        <div class="col-md-8"></div>
                        <div class="col-md-4">
                            <table class="table table-sm">
                                <tr>
                                    <td><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</strong></td>
                                    <td class="text-end">‡∏ø${subtotal.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                                </tr>
                                <tr>
                                    <td><strong>‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° (7%):</strong></td>
                                    <td class="text-end">‡∏ø${vat.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                                </tr>
                                <tr class="table-warning">
                                    <td><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</strong></td>
                                    <td class="text-end"><strong>‡∏ø${grandTotal.toLocaleString('th-TH', {minimumFractionDigits: 2})}</strong></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    ${data.notes ? `<div class="mt-3"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>${data.notes}</div>` : ''}
                </div>
            `;
        }

        // Print order
        function printOrder() {
            const formData = collectFormData();
            const printContent = generatePrintHTML(formData);
            
            const printWindow = window.open('', '_blank', 'width=800,height=600');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        // Generate print HTML
        function generatePrintHTML(data) {
            const subtotal = data.items.reduce((sum, item) => sum + item.total, 0);
            const vat = subtotal * 0.07;
            const grandTotal = subtotal + vat;
            
            let itemsHTML = '';
            data.items.forEach((item, index) => {
                itemsHTML += `
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${index + 1}</td>
                        <td style="border: 1px solid #ddd; padding: 8px;">${item.name}</td>
                        <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${item.quantity}</td>
                        <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${item.unit}</td>
                        <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">‡∏ø${item.price.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                        <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">‡∏ø${item.total.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                    </tr>
                `;
            });
            
            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ${data.poNumber}</title>
                    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
                    <style>
                        body { font-family: 'Prompt', Arial, sans-serif; margin: 20px; line-height: 1.6; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .company-info { margin-bottom: 20px; }
                        .order-info { display: flex; justify-content: space-between; margin-bottom: 20px; }
                        .supplier-info { margin-bottom: 20px; }
                        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; }
                        th { background-color: #FFD700; font-weight: 600; }
                        .total-section { margin-top: 20px; }
                        .signature-section { margin-top: 50px; display: flex; justify-content: space-between; }
                        .signature-box { text-align: center; width: 200px; }
                        .signature-line { border-bottom: 1px solid #000; margin: 30px 0 10px 0; height: 50px; }
                        @media print {
                            body { margin: 0; font-size: 12px; }
                            .signature-line { height: 40px; margin: 20px 0 10px 0; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Purchase Order)</h1>
                        <h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</h2>
                    </div>

                    <div class="company-info">
                        <strong>‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î</strong><br>
                        123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110<br>
                        ‡πÇ‡∏ó‡∏£: 02-123-4567 | ‡∏≠‡∏µ‡πÄ‡∏°‡∏•: info@driedfruit.co.th
                    </div>

                    <div class="order-info">
                        <div>
                            <strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${data.poNumber}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${new Date(data.orderDate).toLocaleDateString('th-TH')}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</strong> ${new Date(data.deliveryDate).toLocaleDateString('th-TH')}
                        </div>
                        <div>
                            <strong>‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${data.buyerName}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå:</strong> ${new Date().toLocaleDateString('th-TH')}<br>
                            <strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${new Date().toLocaleTimeString('th-TH')}
                        </div>
                    </div>

                    <div class="supplier-info">
                        <strong>‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå:</strong><br>
                        ${data.supplier.name}<br>
                        ‡πÇ‡∏ó‡∏£: ${data.supplier.phone}<br>
                        ‡∏≠‡∏µ‡πÄ‡∏°‡∏•: ${data.supplier.email}<br>
                        ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${data.supplier.address}
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                <th>‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                <th>‡∏£‡∏ß‡∏°</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${itemsHTML}
                        </tbody>
                    </table>

                    <div class="total-section">
                        <table style="width: 300px; margin-left: auto;">
                            <tr>
                                <td style="text-align: right; padding: 5px;"><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</strong></td>
                                <td style="text-align: right; padding: 5px;">‡∏ø${subtotal.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                            </tr>
                            <tr>
                                <td style="text-align: right; padding: 5px;"><strong>‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° (7%):</strong></td>
                                <td style="text-align: right; padding: 5px;">‡∏ø${vat.toLocaleString('th-TH', {minimumFractionDigits: 2})}</td>
                            </tr>
                            <tr style="background-color: #FFD700;">
                                <td style="text-align: right; padding: 5px;"><strong>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</strong></td>
                                <td style="text-align: right; padding: 5px;"><strong>‡∏ø${grandTotal.toLocaleString('th-TH', {minimumFractionDigits: 2})}</strong></td>
                            </tr>
                        </table>
                    </div>

                    ${data.notes ? `<div style="margin-top: 20px;"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>${data.notes}</div>` : ''}

                    <div class="signature-section">
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <div>‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
                            <div>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: _______________</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <div>‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                            <div>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: _______________</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <div>‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</div>
                            <div>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: _______________</div>
                        </div>
                    </div>

                    <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #666;">
                        *** ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á ***
                    </div>
                </body>
                </html>
            `;
        }

        // Confirm order
        function confirmOrder() {
            const form = document.getElementById('purchaseForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const formData = collectFormData();
            
            if (formData.items.length === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                return;
            }
            
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                // Save order data
                const orderData = {
                    ...formData,
                    timestamp: new Date().toISOString(),
                    status: 'confirmed'
                };
                
                // Save to localStorage (in real app, send to server)
                localStorage.setItem('lastPurchaseOrder', JSON.stringify(orderData));
                
                // Auto print
                printOrder();
                
                // Send to Line (placeholder)
                sendToLine(orderData);
                
                alert('‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\nüñ®Ô∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏ó‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£\nüì± ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Line');
                
                // Reset form
                if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    location.reload();
                }
            }
        }

        // Send to Line (placeholder function)
        function sendToLine(orderData) {
            // This would integrate with Line API
            console.log('Sending to Line:', orderData);
            
            // Simulate Line message
            const message = `üìã ‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà: ${orderData.poNumber}\n` +
                           `üè¢ ‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå: ${orderData.supplier.name}\n` +
                           `üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${new Date(orderData.orderDate).toLocaleDateString('th-TH')}\n` +
                           `üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ‡∏ø${orderData.items.reduce((sum, item) => sum + item.total, 0).toLocaleString('th-TH')}\n` +
                           `üë§ ‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${orderData.buyerName}`;
            
            // In a real application, you would send this to Line API
            // For now, we'll just log it
            console.log('Line message:', message);
        }
    </script>
</body>
</html>