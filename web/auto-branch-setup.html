<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Branch Setup - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•≠</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gold: #FFD700;
            --primary-orange: #FFA500;
            --primary-deep-orange: #FF8C00;
            --bg-cream: #FFF8DC;
            --bg-light-yellow: #FFFACD;
            --bg-warm-white: #FEFEF7;
            --text-dark: #2C1810;
            --text-brown: #8B4513;
            --success-green: #32CD32;
            --warning-amber: #FFBF00;
            --danger-red: #FF6B6B;
            --shadow-warm: rgba(255, 165, 0, 0.15);
            --shadow-soft: rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Prompt', sans-serif;
            background: linear-gradient(135deg, var(--bg-cream) 0%, var(--bg-light-yellow) 100%);
            color: var(--text-dark);
            min-height: 100vh;
        }

        .setup-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 248, 220, 0.9) 100%);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 900px;
            box-shadow: 0 10px 30px var(--shadow-soft);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .setup-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 3px solid var(--primary-orange);
        }

        .setup-header h1 {
            color: var(--primary-deep-orange);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .step-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
            margin: 0.5rem;
        }

        .progress-step::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: #e0e0e0;
            z-index: 1;
        }

        .progress-step:last-child::before {
            display: none;
        }

        .progress-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin: 0 auto 0.5rem;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .progress-step.completed .progress-circle {
            background: var(--success-green);
        }

        .progress-step.active .progress-circle {
            background: var(--primary-orange);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .progress-step.completed::before {
            background: var(--success-green);
        }

        .progress-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #999;
        }

        .progress-step.active .progress-label,
        .progress-step.completed .progress-label {
            color: var(--text-dark);
            font-weight: 600;
        }

        .setup-content {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px var(--shadow-soft);
        }

        .status-item {
            display: flex;
            justify-content: between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background: var(--bg-light-yellow);
            border-radius: 10px;
            border-left: 4px solid var(--warning-amber);
            transition: all 0.3s ease;
        }

        .status-item.completed {
            border-left-color: var(--success-green);
            background: rgba(50, 205, 50, 0.1);
        }

        .status-item.error {
            border-left-color: var(--danger-red);
            background: rgba(255, 107, 107, 0.1);
        }

        .status-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            color: var(--warning-amber);
        }

        .status-item.completed .status-icon {
            color: var(--success-green);
        }

        .status-item.error .status-icon {
            color: var(--danger-red);
        }

        .status-text {
            flex: 1;
        }

        .status-time {
            font-size: 0.875rem;
            color: #666;
        }

        .log-container {
            background: #1e1e1e;
            color: #00ff00;
            border-radius: 10px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 1rem;
        }

        .log-line {
            margin-bottom: 0.25rem;
        }

        .log-timestamp {
            color: #888;
        }

        .log-success {
            color: #00ff00;
        }

        .log-error {
            color: #ff6b6b;
        }

        .log-warning {
            color: #ffbf00;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-deep-orange) 100%);
            border: none;
            border-radius: 10px;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .completion-summary {
            background: linear-gradient(135deg, rgba(50, 205, 50, 0.1) 0%, rgba(50, 205, 50, 0.05) 100%);
            border: 2px solid var(--success-green);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            margin-top: 2rem;
            display: none;
        }

        .completion-summary.show {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="setup-container">
        <div class="setup-header">
            <h1><i class="fas fa-cogs me-2"></i>Auto Branch Setup</h1>
            <p class="text-muted">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
            <p><strong>‡∏™‡∏≤‡∏Ç‡∏≤:</strong> <span id="branchName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></p>
        </div>

        <!-- Progress Steps -->
        <div class="step-progress">
            <div class="progress-step active" id="step1">
                <div class="progress-circle">1</div>
                <div class="progress-label">‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
            </div>
            <div class="progress-step" id="step2">
                <div class="progress-circle">2</div>
                <div class="progress-label">‡∏™‡∏£‡πâ‡∏≤‡∏á Branch ID</div>
            </div>
            <div class="progress-step" id="step3">
                <div class="progress-circle">3</div>
                <div class="progress-label">‡∏Å‡∏≥‡∏´‡∏ô‡∏î Delivery Zone</div>
            </div>
            <div class="progress-step" id="step4">
                <div class="progress-circle">4</div>
                <div class="progress-label">‡∏™‡∏£‡πâ‡∏≤‡∏á User Account</div>
            </div>
            <div class="progress-step" id="step5">
                <div class="progress-circle">5</div>
                <div class="progress-label">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Inventory</div>
            </div>
            <div class="progress-step" id="step6">
                <div class="progress-circle">6</div>
                <div class="progress-label">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô Delivery Route</div>
            </div>
            <div class="progress-step" id="step7">
                <div class="progress-circle">7</div>
                <div class="progress-label">‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
            </div>
        </div>

        <!-- Setup Status -->
        <div class="setup-content">
            <h4 class="mb-3"><i class="fas fa-tasks me-2"></i>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h4>
            
            <div id="statusList">
                <div class="status-item" id="status-prepare">
                    <div class="status-icon">
                        <div class="spinner"></div>
                    </div>
                    <div class="status-text">
                        <strong>‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤</strong>
                        <div class="text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤...</div>
                    </div>
                    <div class="status-time">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="status-item" id="status-branch-id">
                    <div class="status-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="status-text">
                        <strong>‡∏™‡∏£‡πâ‡∏≤‡∏á Branch ID ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</strong>
                        <div class="text-muted">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≤‡∏Ç‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                    </div>
                    <div class="status-time">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="status-item" id="status-delivery-zone">
                    <div class="status-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="status-text">
                        <strong>‡∏Å‡∏≥‡∏´‡∏ô‡∏î Delivery Zone</strong>
                        <div class="text-muted">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏ã‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á</div>
                    </div>
                    <div class="status-time">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="status-item" id="status-user-account">
                    <div class="status-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="status-text">
                        <strong>‡∏™‡∏£‡πâ‡∏≤‡∏á User Account</strong>
                        <div class="text-muted">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤</div>
                    </div>
                    <div class="status-time">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="status-item" id="status-inventory">
                    <div class="status-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="status-text">
                        <strong>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö Inventory</strong>
                        <div class="text-muted">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
                    </div>
                    <div class="status-time">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="status-item" id="status-delivery-route">
                    <div class="status-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="status-text">
                        <strong>‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô Delivery Route</strong>
                        <div class="text-muted">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á</div>
                    </div>
                    <div class="status-time">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="status-item" id="status-notification">
                    <div class="status-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="status-text">
                        <strong>‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</strong>
                        <div class="text-muted">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
                    </div>
                    <div class="status-time">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>
            </div>
        </div>

        <!-- Setup Log -->
        <div class="setup-content">
            <h4 class="mb-3"><i class="fas fa-terminal me-2"></i>Setup Log</h4>
            <div class="log-container" id="setupLog">
                <div class="log-line">
                    <span class="log-timestamp">[00:00:00]</span> 
                    <span class="log-success">‚úì Auto Branch Setup initialized</span>
                </div>
                <div class="log-line">
                    <span class="log-timestamp">[00:00:01]</span> 
                    <span>Starting branch setup process...</span>
                </div>
            </div>
        </div>

        <!-- Control Buttons -->
        <div class="d-flex justify-content-center gap-3">
            <button class="btn btn-primary" id="startSetupBtn" onclick="startAutoSetup()">
                <i class="fas fa-play me-2"></i>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            </button>
            <button class="btn btn-secondary" id="pauseBtn" onclick="pauseSetup()" disabled>
                <i class="fas fa-pause me-2"></i>‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
            </button>
            <button class="btn btn-danger" id="cancelBtn" onclick="cancelSetup()" disabled>
                <i class="fas fa-stop me-2"></i>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
            </button>
        </div>

        <!-- Completion Summary -->
        <div class="completion-summary" id="completionSummary">
            <i class="fas fa-check-circle fa-4x text-success mb-3"></i>
            <h3 class="text-success">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!</h3>
            <p class="mb-3">‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
            <div class="row">
                <div class="col-md-6">
                    <strong>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≤‡∏Ç‡∏≤:</strong> <span id="finalBranchId">-</span><br>
                    <strong>Delivery Zone:</strong> <span id="finalDeliveryZone">-</span><br>
                    <strong>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£:</strong> <span id="finalManager">-</span>
                </div>
                <div class="col-md-6">
                    <strong>Username:</strong> <span id="finalUsername">-</span><br>
                    <strong>Password:</strong> <span id="finalPassword">-</span><br>
                    <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <span class="text-warning">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                </div>
            </div>
            <div class="mt-3">
                <button class="btn btn-primary me-2" onclick="viewBranchDetails()">
                    <i class="fas fa-eye me-1"></i>‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≤‡∏Ç‡∏≤
                </button>
                <button class="btn btn-success" onclick="sendWelcomeMessage()">
                    <i class="fas fa-paper-plane me-1"></i>‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Line
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let setupData = {};
        let currentStep = 1;
        let isSetupRunning = false;
        let setupInterval;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadBranchData();
        });

        // Load branch data from URL parameters
        function loadBranchData() {
            const urlParams = new URLSearchParams(window.location.search);
            const branchData = {
                id: urlParams.get('id') || 'BR-NEW',
                name: urlParams.get('name') || '‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏°‡πà',
                manager: urlParams.get('manager') || '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤',
                lat: urlParams.get('lat') || '13.7563',
                lng: urlParams.get('lng') || '100.5018',
                province: urlParams.get('province') || '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£'
            };

            setupData = branchData;
            document.getElementById('branchName').textContent = branchData.name;
        }

        // Start auto setup
        function startAutoSetup() {
            if (isSetupRunning) return;

            isSetupRunning = true;
            currentStep = 1;

            // Update button states
            document.getElementById('startSetupBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('cancelBtn').disabled = false;

            // Start setup process
            executeSetupSteps();
        }

        // Execute setup steps
        function executeSetupSteps() {
            const steps = [
                { id: 'prepare', func: prepareData, delay: 2000 },
                { id: 'branch-id', func: generateBranchId, delay: 1500 },
                { id: 'delivery-zone', func: calculateDeliveryZone, delay: 2000 },
                { id: 'user-account', func: createUserAccount, delay: 2500 },
                { id: 'inventory', func: setupInventory, delay: 3000 },
                { id: 'delivery-route', func: addToDeliveryRoute, delay: 1500 },
                { id: 'notification', func: sendNotifications, delay: 2000 }
            ];

            let stepIndex = 0;

            function executeNext() {
                if (!isSetupRunning || stepIndex >= steps.length) {
                    if (stepIndex >= steps.length) {
                        completeSetup();
                    }
                    return;
                }

                const step = steps[stepIndex];
                updateStepStatus(currentStep, 'active');
                
                setTimeout(() => {
                    if (isSetupRunning) {
                        step.func();
                        updateStepStatus(currentStep, 'completed');
                        updateStatusItem(step.id, 'completed');
                        
                        currentStep++;
                        stepIndex++;
                        executeNext();
                    }
                }, step.delay);
            }

            executeNext();
        }

        // Setup step functions
        function prepareData() {
            addLog('‚úì ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            addLog(`‚Üí ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤: ${setupData.name}`, 'info');
            addLog(`‚Üí ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£: ${setupData.manager}`, 'info');
            addLog(`‚Üí ‡∏û‡∏¥‡∏Å‡∏±‡∏î: ${setupData.lat}, ${setupData.lng}`, 'info');
        }

        function generateBranchId() {
            const branchId = `BR-${Date.now().toString().slice(-3)}`;
            setupData.branchId = branchId;
            addLog(`‚úì ‡∏™‡∏£‡πâ‡∏≤‡∏á Branch ID: ${branchId}`, 'success');
            addLog('‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
        }

        function calculateDeliveryZone() {
            // Simple zone calculation based on province
            const zoneMap = {
                '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£': 'ZONE_CENTRAL',
                '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà': 'ZONE_NORTH',
                '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï': 'ZONE_SOUTH',
                '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô': 'ZONE_NORTHEAST'
            };
            
            const zone = zoneMap[setupData.province] || 'ZONE_CENTRAL';
            setupData.deliveryZone = zone;
            addLog(`‚úì ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Delivery Zone: ${zone}`, 'success');
            addLog('‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏ã‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }

        function createUserAccount() {
            const username = `manager_${setupData.branchId.toLowerCase()}`;
            const password = generatePassword();
            
            setupData.username = username;
            setupData.password = password;
            
            addLog(`‚úì ‡∏™‡∏£‡πâ‡∏≤‡∏á User Account: ${username}`, 'success');
            addLog('‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å)', 'warning');
            addLog('‚Üí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Branch Manager ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
        }

        function setupInventory() {
            addLog('‚úì ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï Inventory', 'success');
            addLog('‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'info');
            addLog('‚Üí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Reorder Point ‡πÅ‡∏•‡∏∞ Safety Stock', 'info');
            addLog('‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }

        function addToDeliveryRoute() {
            addLog('‚úì ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Delivery Route', 'success');
            addLog(`‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô ${setupData.deliveryZone} Route`, 'info');
            addLog('‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß', 'info');
            addLog('‚Üí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô', 'info');
        }

        function sendNotifications() {
            addLog('‚úì ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á', 'success');
            addLog('‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Admin ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', 'info');
            addLog('‚Üí ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á Line', 'info');
            addLog('‚Üí ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }

        // Helper functions
        function updateStepStatus(stepNum, status) {
            const step = document.getElementById(`step${stepNum}`);
            if (step) {
                step.className = `progress-step ${status}`;
            }
        }

        function updateStatusItem(statusId, status) {
            const item = document.getElementById(`status-${statusId}`);
            if (item) {
                item.className = `status-item ${status}`;
                
                const icon = item.querySelector('.status-icon');
                const time = item.querySelector('.status-time');
                
                if (status === 'completed') {
                    icon.innerHTML = '<i class="fas fa-check-circle"></i>';
                    time.textContent = '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô';
                } else if (status === 'error') {
                    icon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
                    time.textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î';
                }
            }
        }

        function addLog(message, type = 'info') {
            const logContainer = document.getElementById('setupLog');
            const timestamp = new Date().toLocaleTimeString('th-TH');
            const logClass = type === 'success' ? 'log-success' : 
                           type === 'error' ? 'log-error' : 
                           type === 'warning' ? 'log-warning' : '';
            
            const logLine = document.createElement('div');
            logLine.className = 'log-line';
            logLine.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span> 
                <span class="${logClass}">${message}</span>
            `;
            
            logContainer.appendChild(logLine);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function generatePassword() {
            const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789';
            let password = '';
            for (let i = 0; i < 8; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return password;
        }

        function completeSetup() {
            isSetupRunning = false;
            
            // Update final data
            document.getElementById('finalBranchId').textContent = setupData.branchId;
            document.getElementById('finalDeliveryZone').textContent = setupData.deliveryZone;
            document.getElementById('finalManager').textContent = setupData.manager;
            document.getElementById('finalUsername').textContent = setupData.username;
            document.getElementById('finalPassword').textContent = setupData.password;
            
            // Show completion summary
            document.getElementById('completionSummary').classList.add('show');
            
            // Update buttons
            document.getElementById('startSetupBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('cancelBtn').disabled = true;
            
            addLog('üéâ Auto Branch Setup completed successfully!', 'success');
            addLog('‚Üí ‡∏™‡∏≤‡∏Ç‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥', 'info');
        }

        function pauseSetup() {
            isSetupRunning = false;
            document.getElementById('startSetupBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            addLog('‚è∏Ô∏è Setup paused by user', 'warning');
        }

        function cancelSetup() {
            if (confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤?')) {
                isSetupRunning = false;
                addLog('‚ùå Setup cancelled by user', 'error');
                window.close();
            }
        }

        function viewBranchDetails() {
            window.open(`/branch-details?id=${setupData.branchId}`, '_blank');
        }

        function sendWelcomeMessage() {
            const message = `üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏°‡πà!\n\n` +
                          `üìç ‡∏™‡∏≤‡∏Ç‡∏≤: ${setupData.name}\n` +
                          `üÜî ‡∏£‡∏´‡∏±‡∏™: ${setupData.branchId}\n` +
                          `üë§ ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£: ${setupData.manager}\n\n` +
                          `üì± ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:\n` +
                          `Username: ${setupData.username}\n` +
                          `Password: ${setupData.password}\n\n` +
                          `‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å`;
            
            // In real implementation, send to Line API
            navigator.clipboard.writeText(message).then(() => {
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡πà‡∏á‡πÉ‡∏ô Line');
            });
        }
    </script>
</body>
</html>