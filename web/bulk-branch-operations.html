<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏° - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•≠</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-gold: #FFD700;
            --primary-orange: #FFA500;
            --primary-deep-orange: #FF8C00;
            --bg-cream: #FFF8DC;
            --bg-light-yellow: #FFFACD;
            --bg-warm-white: #FEFEF7;
            --text-dark: #2C1810;
            --text-brown: #8B4513;
            --success-green: #32CD32;
            --warning-amber: #FFBF00;
            --danger-red: #FF6B6B;
            --shadow-warm: rgba(255, 165, 0, 0.15);
            --shadow-soft: rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Prompt', sans-serif;
            background: linear-gradient(135deg, var(--bg-cream) 0%, var(--bg-light-yellow) 100%);
            color: var(--text-dark);
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--primary-orange) 100%);
            padding: 1rem 0;
            box-shadow: 0 4px 20px var(--shadow-warm);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--text-dark) !important;
        }

        .bulk-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 248, 220, 0.8) 100%);
            border-radius: 20px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 5px 15px var(--shadow-soft);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .operation-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px var(--shadow-soft);
            border-left: 4px solid var(--primary-orange);
            transition: all 0.3s ease;
        }

        .operation-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-soft);
        }

        .action-btn {
            background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-deep-orange) 100%);
            border: none;
            border-radius: 10px;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 0.25rem;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.4);
            color: white;
        }

        .action-btn.danger {
            background: linear-gradient(135deg, var(--danger-red) 0%, #FF1493 100%);
        }

        .action-btn.success {
            background: linear-gradient(135deg, var(--success-green) 0%, #00FF7F 100%);
        }

        .action-btn.warning {
            background: linear-gradient(135deg, var(--warning-amber) 0%, #FFD700 100%);
            color: var(--text-dark);
        }

        .selection-panel {
            background: white;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px var(--shadow-soft);
            border: 2px solid var(--primary-orange);
        }

        .branch-checkbox {
            transform: scale(1.2);
            margin-right: 0.5rem;
        }

        .branch-item {
            background: var(--bg-light-yellow);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .branch-item:hover {
            background: white;
            box-shadow: 0 2px 8px var(--shadow-soft);
        }

        .branch-item.selected {
            background: rgba(255, 165, 0, 0.2);
            border: 2px solid var(--primary-orange);
        }

        .progress-section {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 3px 10px var(--shadow-soft);
            border: 1px solid rgba(255, 215, 0, 0.2);
            margin-bottom: 1.5rem;
        }

        .progress-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            background: var(--bg-light-yellow);
        }

        .progress-item.completed {
            background: rgba(50, 205, 50, 0.2);
            color: var(--success-green);
        }

        .progress-item.failed {
            background: rgba(255, 107, 107, 0.2);
            color: var(--danger-red);
        }

        .progress-item.processing {
            background: rgba(255, 191, 0, 0.2);
            color: var(--warning-amber);
        }

        .template-section {
            background: linear-gradient(135deg, rgba(0, 123, 255, 0.1) 0%, rgba(255, 165, 0, 0.1) 100%);
            border-radius: 15px;
            padding: 1.5rem;
            border-left: 4px solid #007bff;
            margin-bottom: 1.5rem;
        }

        .template-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px var(--shadow-soft);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-soft);
        }

        .filter-section {
            background: white;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px var(--shadow-soft);
            border: 2px solid var(--primary-orange);
        }

        .filter-btn {
            background: linear-gradient(135deg, var(--bg-light-yellow) 0%, white 100%);
            border: 2px solid var(--primary-orange);
            color: var(--text-dark);
            border-radius: 10px;
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .filter-btn.active, .filter-btn:hover {
            background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-deep-orange) 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
        }

        .stats-summary {
            background: linear-gradient(135deg, rgba(50, 205, 50, 0.1) 0%, rgba(255, 215, 0, 0.1) 100%);
            border-radius: 15px;
            padding: 1.5rem;
            border-left: 4px solid var(--success-green);
            margin-bottom: 1.5rem;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 248, 220, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.show {
            display: flex;
        }

        .batch-selector {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 2px dashed var(--primary-orange);
        }

        .drag-drop-zone {
            border: 2px dashed var(--primary-orange);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            background: rgba(255, 165, 0, 0.05);
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .drag-drop-zone:hover {
            background: rgba(255, 165, 0, 0.1);
            border-color: var(--primary-deep-orange);
        }

        .drag-drop-zone.drag-over {
            background: rgba(255, 165, 0, 0.2);
            border-color: var(--primary-deep-orange);
            transform: scale(1.02);
        }

        .scheduler-section {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.1) 0%, rgba(255, 165, 0, 0.1) 100%);
            border-radius: 15px;
            padding: 1.5rem;
            border-left: 4px solid #8A2BE2;
            margin-bottom: 1.5rem;
        }

        .time-slot {
            background: white;
            border-radius: 8px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border: 1px solid rgba(255, 215, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-slot:hover {
            background: var(--bg-light-yellow);
            border-color: var(--primary-orange);
        }

        .time-slot.selected {
            background: rgba(255, 165, 0, 0.2);
            border-color: var(--primary-orange);
            border-width: 2px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-layer-group me-2"></i>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="/dashboard">
                            <i class="fas fa-home me-1"></i>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="/branch-management">
                            <i class="fas fa-store me-1"></i>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="/branch-analytics">
                            <i class="fas fa-chart-line me-1"></i>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="text-center">
            <div class="spinner-border text-warning" style="width: 3rem; height: 3rem;" role="status">
                <span class="visually-hidden">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...</span>
            </div>
            <p class="mt-3 text-dark">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°...</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Filter and Selection Section -->
        <div class="filter-section">
            <h5 class="mb-3"><i class="fas fa-filter me-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</h5>
            <div class="row align-items-center">
                <div class="col-md-3">
                    <label class="form-label fw-bold">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏†‡∏≤‡∏Ñ:</label>
                    <div>
                        <button class="filter-btn active" onclick="filterByRegion('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        <button class="filter-btn" onclick="filterByRegion('north')">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠</button>
                        <button class="filter-btn" onclick="filterByRegion('central')">‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á</button>
                        <button class="filter-btn" onclick="filterByRegion('northeast')">‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô</button>
                        <button class="filter-btn" onclick="filterByRegion('south')">‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Ç‡∏ô‡∏≤‡∏î:</label>
                    <div>
                        <button class="filter-btn" onclick="filterBySize('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        <button class="filter-btn" onclick="filterBySize('large')">‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏ç‡πà</button>
                        <button class="filter-btn" onclick="filterBySize('medium')">‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏•‡∏≤‡∏á</button>
                        <button class="filter-btn" onclick="filterBySize('small')">‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏•‡πá‡∏Å</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
                    <div>
                        <button class="filter-btn" onclick="filterByStatus('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        <button class="filter-btn" onclick="filterByStatus('active')">‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</button>
                        <button class="filter-btn" onclick="filterByStatus('inactive')">‡∏õ‡∏¥‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏ß‡∏ô:</label>
                    <div>
                        <button class="action-btn btn-sm" onclick="selectAll()">
                            <i class="fas fa-check-square me-1"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </button>
                        <button class="action-btn btn-sm warning" onclick="clearSelection()">
                            <i class="fas fa-times me-1"></i>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Batch Selector -->
        <div class="batch-selector">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h6 class="mb-0">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: <span id="selectedCount">0</span> ‡∏™‡∏≤‡∏Ç‡∏≤
                    </h6>
                </div>
                <div class="col-md-6 text-end">
                    <button class="btn btn-outline-primary btn-sm" onclick="showSelectedBranches()">
                        <i class="fas fa-eye me-1"></i>‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    </button>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Branch Selection Panel -->
            <div class="col-lg-8">
                <div class="selection-panel">
                    <h5 class="mb-3"><i class="fas fa-list me-2"></i>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤</h5>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <input type="text" class="form-control" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏≤‡∏Ç‡∏≤..." id="searchBranch" onkeyup="searchBranches()">
                        </div>
                        <div class="col-md-6 mb-3">
                            <select class="form-select" id="sortBy" onchange="sortBranches()">
                                <option value="name">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠</option>
                                <option value="region">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏†‡∏≤‡∏Ñ</option>
                                <option value="performance">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</option>
                                <option value="revenue">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</option>
                            </select>
                        </div>
                    </div>
                    <div id="branchList" style="max-height: 400px; overflow-y: auto;">
                        <!-- Branch items will be dynamically loaded here -->
                    </div>
                </div>
            </div>

            <!-- Quick Actions Panel -->
            <div class="col-lg-4">
                <div class="stats-summary">
                    <h5 class="mb-3"><i class="fas fa-chart-bar me-2"></i>‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</h5>
                    <div class="row text-center">
                        <div class="col-6 mb-2">
                            <div class="fw-bold text-primary" id="totalSelected">0</div>
                            <small>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</small>
                        </div>
                        <div class="col-6 mb-2">
                            <div class="fw-bold text-success" id="totalRevenue">‡∏ø0</div>
                            <small>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</small>
                        </div>
                        <div class="col-6">
                            <div class="fw-bold text-warning" id="avgPerformance">0%</div>
                            <small>‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</small>
                        </div>
                        <div class="col-6">
                            <div class="fw-bold text-info" id="regionCount">0</div>
                            <small>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏†‡∏π‡∏°‡∏¥‡∏†‡∏≤‡∏Ñ</small>
                        </div>
                    </div>
                </div>

                <!-- Template Operations -->
                <div class="template-section">
                    <h5 class="mb-3"><i class="fas fa-magic me-2"></i>‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h5>
                    <div class="template-card" onclick="applyTemplate('price-update')">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-tag text-primary me-3"></i>
                            <div>
                                <h6 class="mb-1">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h6>
                                <small class="text-muted">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤</small>
                            </div>
                        </div>
                    </div>

                    <div class="template-card" onclick="applyTemplate('promotion')">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-percentage text-warning me-3"></i>
                            <div>
                                <h6 class="mb-1">‡∏™‡πà‡∏á‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</h6>
                                <small class="text-muted">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°</small>
                            </div>
                        </div>
                    </div>

                    <div class="template-card" onclick="applyTemplate('stock-adjustment')">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-boxes text-success me-3"></i>
                            <div>
                                <h6 class="mb-1">‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Ñ</h6>
                                <small class="text-muted">‡πÇ‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤</small>
                            </div>
                        </div>
                    </div>

                    <div class="template-card" onclick="applyTemplate('notification')">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-bell text-info me-3"></i>
                            <div>
                                <h6 class="mb-1">‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h6>
                                <small class="text-muted">‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bulk Operations Section -->
        <div class="bulk-container">
            <h4 class="mb-4"><i class="fas fa-layer-group me-2"></i>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°</h4>
            
            <div class="row">
                <div class="col-lg-6">
                    <div class="operation-card">
                        <h5 class="mb-3"><i class="fas fa-cogs me-2"></i>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h5>
                        <div class="d-grid gap-2">
                            <button class="action-btn" onclick="showBulkOperation('price-update')">
                                <i class="fas fa-tag me-2"></i>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                            </button>
                            <button class="action-btn" onclick="showBulkOperation('stock-transfer')">
                                <i class="fas fa-exchange-alt me-2"></i>‡πÇ‡∏≠‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏Ç‡∏≤
                            </button>
                            <button class="action-btn" onclick="showBulkOperation('promotion')">
                                <i class="fas fa-percentage me-2"></i>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                            </button>
                            <button class="action-btn warning" onclick="showBulkOperation('maintenance')">
                                <i class="fas fa-tools me-2"></i>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á
                            </button>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="operation-card">
                        <h5 class="mb-3"><i class="fas fa-shield-alt me-2"></i>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á</h5>
                        <div class="d-grid gap-2">
                            <button class="action-btn success" onclick="showBulkOperation('performance-boost')">
                                <i class="fas fa-rocket me-2"></i>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢ AI
                            </button>
                            <button class="action-btn" onclick="showBulkOperation('backup')">
                                <i class="fas fa-cloud-download-alt me-2"></i>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                            </button>
                            <button class="action-btn" onclick="showBulkOperation('report-generation')">
                                <i class="fas fa-file-alt me-2"></i>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤
                            </button>
                            <button class="action-btn danger" onclick="showBulkOperation('emergency-shutdown')">
                                <i class="fas fa-power-off me-2"></i>‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scheduler Section -->
        <div class="scheduler-section">
            <h5 class="mb-3"><i class="fas fa-clock me-2"></i>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h5>
            <div class="row">
                <div class="col-md-4">
                    <label class="form-label fw-bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤:</label>
                    <select class="form-select" id="scheduleType" onchange="updateScheduleOptions()">
                        <option value="immediate">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</option>
                        <option value="scheduled">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞</option>
                        <option value="recurring">‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î</option>
                        <option value="conditional">‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</option>
                    </select>
                </div>
                <div class="col-md-4" id="dateTimeSection" style="display: none;">
                    <label class="form-label fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤:</label>
                    <input type="datetime-local" class="form-control" id="scheduledDateTime">
                </div>
                <div class="col-md-4" id="recurringSection" style="display: none;">
                    <label class="form-label fw-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà:</label>
                    <select class="form-select" id="recurringFreq">
                        <option value="daily">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                        <option value="weekly">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</option>
                        <option value="monthly">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                        <option value="quarterly">‡∏£‡∏≤‡∏¢‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™</option>
                    </select>
                </div>
            </div>
            
            <div class="row mt-3" id="timeSlotSection">
                <div class="col-12">
                    <label class="form-label fw-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°:</label>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="time-slot" onclick="selectTimeSlot(this, 'morning')">
                                <i class="fas fa-sun text-warning me-2"></i>
                                <strong>‡πÄ‡∏ä‡πâ‡∏≤ (06:00-12:00)</strong>
                                <br><small>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ï‡πä‡∏≠‡∏Ñ</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="time-slot" onclick="selectTimeSlot(this, 'afternoon')">
                                <i class="fas fa-sun text-orange me-2"></i>
                                <strong>‡∏ö‡πà‡∏≤‡∏¢ (12:00-18:00)</strong>
                                <br><small>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="time-slot" onclick="selectTimeSlot(this, 'evening')">
                                <i class="fas fa-moon text-info me-2"></i>
                                <strong>‡πÄ‡∏¢‡πá‡∏ô (18:00-24:00)</strong>
                                <br><small>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="time-slot" onclick="selectTimeSlot(this, 'night')">
                                <i class="fas fa-star text-dark me-2"></i>
                                <strong>‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô (00:00-06:00)</strong>
                                <br><small>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Monitoring -->
        <div class="progress-section" id="progressSection" style="display: none;">
            <h5 class="mb-3"><i class="fas fa-tasks me-2"></i>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</h5>
            <div class="row mb-3">
                <div class="col-md-3">
                    <div class="text-center">
                        <div class="h4 text-success mb-1" id="completedCount">0</div>
                        <small>‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center">
                        <div class="h4 text-warning mb-1" id="processingCount">0</div>
                        <small>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center">
                        <div class="h4 text-danger mb-1" id="failedCount">0</div>
                        <small>‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center">
                        <div class="h4 text-info mb-1" id="totalProgress">0%</div>
                        <small>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</small>
                    </div>
                </div>
            </div>
            
            <div class="progress mb-3" style="height: 10px;">
                <div class="progress-bar bg-success" id="progressBar" style="width: 0%"></div>
            </div>
            
            <div id="progressDetails" style="max-height: 300px; overflow-y: auto;">
                <!-- Progress items will be added here dynamically -->
            </div>

            <div class="text-center mt-3">
                <button class="action-btn warning" onclick="pauseOperations()">
                    <i class="fas fa-pause me-2"></i>‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
                </button>
                <button class="action-btn danger" onclick="cancelOperations()">
                    <i class="fas fa-stop me-2"></i>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
                <button class="action-btn" onclick="downloadProgressReport()">
                    <i class="fas fa-download me-2"></i>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                </button>
            </div>
        </div>

    </div>

    <!-- Modals for Bulk Operations -->
    <div class="modal fade" id="bulkOperationModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-warning bg-gradient">
                    <h5 class="modal-title" id="operationModalTitle">
                        <i class="fas fa-cogs me-2"></i>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="operationModalBody">
                    <!-- Dynamic content will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="button" class="action-btn" id="executeOperationBtn" onclick="executeOperation()">
                        <i class="fas fa-play me-2"></i>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let selectedBranches = new Set();
        let allBranches = [];
        let filteredBranches = [];
        let currentOperation = null;
        let operationInterval = null;

        // Sample branch data
        const sampleBranches = [
            { id: 'BR001', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏£‡∏±‡∏•‡πÄ‡∏ß‡∏¥‡∏•‡∏î‡πå', region: 'central', size: 'large', status: 'active', revenue: 3200000, performance: 95.2 },
            { id: 'BR002', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏¥‡∏°‡∏°‡∏≤‡∏ô', region: 'north', size: 'medium', status: 'active', revenue: 2800000, performance: 92.8 },
            { id: 'BR003', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï‡∏ö‡∏¥‡πä‡∏Å‡∏ã‡∏µ', region: 'south', size: 'large', status: 'active', revenue: 2900000, performance: 90.1 },
            { id: 'BR004', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏£‡∏±‡∏•', region: 'northeast', size: 'medium', status: 'active', revenue: 2400000, performance: 88.7 },
            { id: 'BR005', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏•‡∏µ ‡∏Å‡∏≤‡∏£‡πå‡πÄ‡∏î‡∏ô', region: 'south', size: 'medium', status: 'active', revenue: 2200000, performance: 86.3 },
            { id: 'BR006', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ‡∏ã‡∏µ‡∏Ñ‡∏≠‡∏ô', region: 'northeast', size: 'small', status: 'active', revenue: 2100000, performance: 84.9 },
            { id: 'BR007', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏Å‡∏≤', region: 'central', size: 'medium', status: 'inactive', revenue: 2000000, performance: 83.5 },
            { id: 'BR008', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤‡πÄ‡∏î‡∏≠‡∏∞‡∏°‡∏≠‡∏•‡∏•‡πå', region: 'northeast', size: 'large', status: 'active', revenue: 1900000, performance: 82.1 },
            { id: 'BR009', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏£‡∏±‡∏•', region: 'south', size: 'small', status: 'active', revenue: 1800000, performance: 80.7 },
            { id: 'BR010', name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ‡πÇ‡∏£‡∏ö‡∏¥‡∏ô‡∏™‡∏±‡∏ô', region: 'central', size: 'small', status: 'active', revenue: 1700000, performance: 79.3 }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            allBranches = [...sampleBranches];
            filteredBranches = [...allBranches];
            displayBranches();
            updateSelectionStats();
            setupDragDrop();
        });

        function filterByRegion(region) {
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (region === 'all') {
                filteredBranches = [...allBranches];
            } else {
                filteredBranches = allBranches.filter(branch => branch.region === region);
            }
            displayBranches();
        }

        function filterBySize(size) {
            if (size === 'all') {
                filteredBranches = [...allBranches];
            } else {
                filteredBranches = allBranches.filter(branch => branch.size === size);
            }
            displayBranches();
        }

        function filterByStatus(status) {
            if (status === 'all') {
                filteredBranches = [...allBranches];
            } else {
                filteredBranches = allBranches.filter(branch => branch.status === status);
            }
            displayBranches();
        }

        function displayBranches() {
            const branchList = document.getElementById('branchList');
            branchList.innerHTML = '';

            filteredBranches.forEach(branch => {
                const isSelected = selectedBranches.has(branch.id);
                const statusIcon = branch.status === 'active' ? 'text-success fa-circle' : 'text-danger fa-circle';
                const sizeIcon = branch.size === 'large' ? 'fa-building' : branch.size === 'medium' ? 'fa-store' : 'fa-shop';
                
                const branchItem = `
                    <div class="branch-item ${isSelected ? 'selected' : ''}" onclick="toggleBranchSelection('${branch.id}')">
                        <div class="d-flex align-items-center">
                            <input type="checkbox" class="branch-checkbox" ${isSelected ? 'checked' : ''} onchange="event.stopPropagation(); toggleBranchSelection('${branch.id}')">
                            <div class="flex-grow-1 ms-2">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h6 class="mb-1">${branch.name}</h6>
                                        <div class="d-flex align-items-center text-muted small">
                                            <i class="fas ${statusIcon} me-1"></i>
                                            <span class="me-3">${getRegionText(branch.region)}</span>
                                            <i class="fas ${sizeIcon} me-1"></i>
                                            <span class="me-3">${getSizeText(branch.size)}</span>
                                            <i class="fas fa-chart-line me-1"></i>
                                            <span>${branch.performance}%</span>
                                        </div>
                                    </div>
                                    <div class="text-end">
                                        <div class="fw-bold text-primary">‚Çø${(branch.revenue / 1000000).toFixed(1)}M</div>
                                        <small class="text-muted">${branch.id}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                branchList.innerHTML += branchItem;
            });
        }

        function toggleBranchSelection(branchId) {
            if (selectedBranches.has(branchId)) {
                selectedBranches.delete(branchId);
            } else {
                selectedBranches.add(branchId);
            }
            displayBranches();
            updateSelectionStats();
        }

        function selectAll() {
            filteredBranches.forEach(branch => selectedBranches.add(branch.id));
            displayBranches();
            updateSelectionStats();
        }

        function clearSelection() {
            selectedBranches.clear();
            displayBranches();
            updateSelectionStats();
        }

        function updateSelectionStats() {
            const selectedCount = selectedBranches.size;
            const selectedBranchData = allBranches.filter(branch => selectedBranches.has(branch.id));
            
            const totalRevenue = selectedBranchData.reduce((sum, branch) => sum + branch.revenue, 0);
            const avgPerformance = selectedBranchData.length > 0 ? 
                selectedBranchData.reduce((sum, branch) => sum + branch.performance, 0) / selectedBranchData.length : 0;
            
            const regions = new Set(selectedBranchData.map(branch => branch.region));
            
            document.getElementById('selectedCount').textContent = selectedCount;
            document.getElementById('totalSelected').textContent = selectedCount;
            document.getElementById('totalRevenue').textContent = `‡∏ø${(totalRevenue / 1000000).toFixed(1)}M`;
            document.getElementById('avgPerformance').textContent = `${avgPerformance.toFixed(1)}%`;
            document.getElementById('regionCount').textContent = regions.size;
        }

        function searchBranches() {
            const searchTerm = document.getElementById('searchBranch').value.toLowerCase();
            filteredBranches = allBranches.filter(branch => 
                branch.name.toLowerCase().includes(searchTerm) ||
                branch.id.toLowerCase().includes(searchTerm)
            );
            displayBranches();
        }

        function sortBranches() {
            const sortBy = document.getElementById('sortBy').value;
            
            switch(sortBy) {
                case 'name':
                    filteredBranches.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'region':
                    filteredBranches.sort((a, b) => a.region.localeCompare(b.region));
                    break;
                case 'performance':
                    filteredBranches.sort((a, b) => b.performance - a.performance);
                    break;
                case 'revenue':
                    filteredBranches.sort((a, b) => b.revenue - a.revenue);
                    break;
            }
            displayBranches();
        }

        function showBulkOperation(operationType) {
            if (selectedBranches.size === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£');
                return;
            }
            
            currentOperation = operationType;
            const modal = new bootstrap.Modal(document.getElementById('bulkOperationModal'));
            const modalTitle = document.getElementById('operationModalTitle');
            const modalBody = document.getElementById('operationModalBody');
            
            // Set modal content based on operation type
            switch(operationType) {
                case 'price-update':
                    modalTitle.innerHTML = '<i class="fas fa-tag me-2"></i>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°';
                    modalBody.innerHTML = `
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
                                <select class="form-select" id="productCategory">
                                    <option value="all">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                                    <option value="dried-fruits">‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</option>
                                    <option value="nuts">‡∏ñ‡∏±‡πà‡∏ß‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡∏ä‡∏ú‡∏•</option>
                                    <option value="snacks">‡∏Ç‡∏ô‡∏°‡∏Ç‡∏ö‡πÄ‡∏Ñ‡∏µ‡πâ‡∏¢‡∏ß</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤:</label>
                                <select class="form-select" id="priceMethod">
                                    <option value="percentage">‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</option>
                                    <option value="fixed">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà</option>
                                    <option value="new-price">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡∏°‡πà</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <label class="form-label">‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö:</label>
                                <input type="number" class="form-control" id="priceValue" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 10%">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•:</label>
                                <input type="date" class="form-control" id="effectiveDate">
                            </div>
                        </div>
                        <div class="mt-3">
                            <label class="form-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
                            <textarea class="form-control" id="priceNote" rows="3" placeholder="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤..."></textarea>
                        </div>
                    `;
                    break;
                    
                case 'stock-transfer':
                    modalTitle.innerHTML = '<i class="fas fa-exchange-alt me-2"></i>‡πÇ‡∏≠‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Ñ‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°';
                    modalBody.innerHTML = `
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">‡∏™‡∏≤‡∏Ç‡∏≤‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á:</label>
                                <select class="form-select" id="sourceBranch">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á</option>
                                    ${allBranches.map(branch => `<option value="${branch.id}">${branch.name}</option>`).join('')}
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô:</label>
                                <select class="form-select" id="transferType">
                                    <option value="equal">‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏ó‡πà‡∏≤‡πÜ ‡∏Å‡∏±‡∏ô</option>
                                    <option value="proportional">‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</option>
                                    <option value="custom">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <label class="form-label">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
                                <select class="form-select" id="transferProduct">
                                    <option value="mango">‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</option>
                                    <option value="banana">‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏´‡∏≠‡∏°‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</option>
                                    <option value="pineapple">‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏° (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°):</label>
                                <input type="number" class="form-control" id="transferQuantity" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100">
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'promotion':
                    modalTitle.innerHTML = '<i class="fas fa-percentage me-2"></i>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°';
                    modalBody.innerHTML = `
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô:</label>
                                <input type="text" class="form-control" id="promotionName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î:</label>
                                <select class="form-select" id="discountType">
                                    <option value="percentage">‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</option>
                                    <option value="fixed">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà</option>
                                    <option value="buy-get">‡∏ã‡∏∑‡πâ‡∏≠ X ‡πÑ‡∏î‡πâ Y</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-4">
                                <label class="form-label">‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î:</label>
                                <input type="number" class="form-control" id="discountValue">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°:</label>
                                <input type="date" class="form-control" id="startDate">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label>
                                <input type="date" class="form-control" id="endDate">
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    modalTitle.innerHTML = '<i class="fas fa-cogs me-2"></i>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°';
                    modalBody.innerHTML = '<p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ...</p>';
            }
            
            modal.show();
        }

        function executeOperation() {
            if (selectedBranches.size === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£');
                return;
            }
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('bulkOperationModal')).hide();
            
            // Show progress section
            document.getElementById('progressSection').style.display = 'block';
            
            // Start operation simulation
            startOperationProgress();
        }

        function startOperationProgress() {
            const selectedBranchIds = Array.from(selectedBranches);
            const progressDetails = document.getElementById('progressDetails');
            progressDetails.innerHTML = '';
            
            let completed = 0;
            let processing = 0;
            let failed = 0;
            
            // Reset counters
            document.getElementById('completedCount').textContent = '0';
            document.getElementById('processingCount').textContent = selectedBranchIds.length;
            document.getElementById('failedCount').textContent = '0';
            document.getElementById('totalProgress').textContent = '0%';
            
            selectedBranchIds.forEach((branchId, index) => {
                const branch = allBranches.find(b => b.id === branchId);
                const progressItem = document.createElement('div');
                progressItem.className = 'progress-item processing';
                progressItem.innerHTML = `
                    <i class="fas fa-spinner fa-spin me-2"></i>
                    <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•: ${branch.name}</span>
                    <div class="ms-auto">
                        <small class="text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...</small>
                    </div>
                `;
                progressDetails.appendChild(progressItem);
                
                // Simulate processing time
                setTimeout(() => {
                    const success = Math.random() > 0.1; // 90% success rate
                    
                    if (success) {
                        progressItem.className = 'progress-item completed';
                        progressItem.innerHTML = `
                            <i class="fas fa-check-circle me-2"></i>
                            <span>‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${branch.name}</span>
                            <div class="ms-auto">
                                <small class="text-success">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</small>
                            </div>
                        `;
                        completed++;
                    } else {
                        progressItem.className = 'progress-item failed';
                        progressItem.innerHTML = `
                            <i class="fas fa-times-circle me-2"></i>
                            <span>‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${branch.name}</span>
                            <div class="ms-auto">
                                <small class="text-danger">‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</small>
                            </div>
                        `;
                        failed++;
                    }
                    
                    processing--;
                    
                    // Update counters
                    document.getElementById('completedCount').textContent = completed;
                    document.getElementById('processingCount').textContent = processing;
                    document.getElementById('failedCount').textContent = failed;
                    
                    const progress = ((completed + failed) / selectedBranchIds.length) * 100;
                    document.getElementById('totalProgress').textContent = `${Math.round(progress)}%`;
                    document.getElementById('progressBar').style.width = `${progress}%`;
                    
                }, (index + 1) * 1000 + Math.random() * 2000);
            });
        }

        function updateScheduleOptions() {
            const scheduleType = document.getElementById('scheduleType').value;
            const dateTimeSection = document.getElementById('dateTimeSection');
            const recurringSection = document.getElementById('recurringSection');
            const timeSlotSection = document.getElementById('timeSlotSection');
            
            switch(scheduleType) {
                case 'immediate':
                    dateTimeSection.style.display = 'none';
                    recurringSection.style.display = 'none';
                    timeSlotSection.style.display = 'none';
                    break;
                case 'scheduled':
                    dateTimeSection.style.display = 'block';
                    recurringSection.style.display = 'none';
                    timeSlotSection.style.display = 'block';
                    break;
                case 'recurring':
                    dateTimeSection.style.display = 'block';
                    recurringSection.style.display = 'block';
                    timeSlotSection.style.display = 'block';
                    break;
                case 'conditional':
                    dateTimeSection.style.display = 'none';
                    recurringSection.style.display = 'none';
                    timeSlotSection.style.display = 'block';
                    break;
            }
        }

        function selectTimeSlot(element, timeSlot) {
            document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
            element.classList.add('selected');
        }

        function setupDragDrop() {
            const dragDropZone = document.getElementById('dragDropZone');
            
            dragDropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dragDropZone.classList.add('drag-over');
            });
            
            dragDropZone.addEventListener('dragleave', () => {
                dragDropZone.classList.remove('drag-over');
            });
            
            dragDropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dragDropZone.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload({ target: { files: files } });
                }
            });
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const allowedTypes = ['.csv', '.xlsx', '.xls'];
            const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
            
            if (!allowedTypes.includes(fileExtension)) {
                alert('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå CSV ‡πÅ‡∏•‡∏∞ Excel ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
                return;
            }
            
            // Simulate file processing
            showLoading(true);
            setTimeout(() => {
                alert(`‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå ${file.name} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 50 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 48 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                showLoading(false);
            }, 2000);
        }

        function downloadTemplate(templateType) {
            alert(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö: ${templateType}`);
        }

        function applyTemplate(templateType) {
            if (selectedBranches.size === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö');
                return;
            }
            
            showBulkOperation(templateType);
        }

        function showSelectedBranches() {
            const selectedBranchData = allBranches.filter(branch => selectedBranches.has(branch.id));
            const branchNames = selectedBranchData.map(branch => branch.name).join('\n');
            alert(`‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (${selectedBranches.size} ‡πÅ‡∏´‡πà‡∏á):\n\n${branchNames}`);
        }

        function pauseOperations() {
            alert('‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß');
        }

        function cancelOperations() {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                document.getElementById('progressSection').style.display = 'none';
                alert('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        function downloadProgressReport() {
            alert('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤...');
        }

        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.add('show');
            } else {
                overlay.classList.remove('show');
            }
        }

        // Helper functions
        function getRegionText(region) {
            const regionMap = {
                'north': '‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠',
                'central': '‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á',
                'northeast': '‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô',
                'south': '‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ'
            };
            return regionMap[region] || region;
        }

        function getSizeText(size) {
            const sizeMap = {
                'large': '‡πÉ‡∏´‡∏ç‡πà',
                'medium': '‡∏Å‡∏•‡∏≤‡∏á',
                'small': '‡πÄ‡∏•‡πá‡∏Å'
            };
            return sizeMap[size] || size;
        }
    </script>
</body>
</html>